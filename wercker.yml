box: bringnow/android-sdk
command-timeout: 60
build:
  steps:
    - npm-install
  use-cache: false
    - script:
        name: flow
        code: npm run flow
    - script:
        name: eslint
        code: npm run lint
    - npm-test
    - script:
        name: echo nodejs information
        code: |
          echo "node version $(node -v) running"
          echo "npm version $(npm -v) running"

deploy-debug:
  steps:
    - create-file:
      name: Create crashlytics.properties
      filename: android/app/crashlytics.properties
      overwrite: true
      content: |-
        apiKey=$FABRIC_API_KEY
        apiSecret=$FABRIC_BUILD_SECRET
    - script:
      name: Build app and Deploy to Fabric
      cwd: android
      code: ./gradlew assembleDebug -PbundleInDebug=true -PversionName="$(git describe | sed -e 's/^v//')" crashlyticsUploadDistributionDebug
